-- ATIVAR A FOREIGN_KEY: PRAGMA foreign_keys = ON; CHECK IF IS ENABLE => PRAGMA foreign_keys;
-- sqlite3 database.db -init dump.sql

CREATE TABLE IF NOT EXISTS TB_DEVICE (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cod INTEGER NOT NULL,
    desc text NOT NULL,
    key text NOT NULL
);

CREATE TABLE IF NOT EXISTS TB_PARAM (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cod INTEGER NOT NULL,
    desc text NOT NULL
);

CREATE TABLE IF NOT EXISTS TB_DEVICE_PARAM (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    fk_device INTEGER NOT NULL,
    fk_param INTEGER NOT NULL,
    FOREIGN KEY (fk_device) REFERENCES TB_DEVICE (id) ON DELETE RESTRICT,
    FOREIGN KEY (fk_param) REFERENCES TB_PARAM (id) ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS TB_LOG (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    fk_device_param INTEGER NOT NULL,
    value text,
    data_hora text,
    FOREIGN KEY (fk_device_param) REFERENCES TB_DEVICE_PARAM (id) ON DELETE RESTRICT
);

PRAGMA foreign_keys = ON;